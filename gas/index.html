<!DOCTYPE html>
<html>

<head>
  <title>入退室チェック</title>
  <base target="_top">
</head>

<body>
  <h1>青学つくまなラボ入退室チェック</h1>

  <div id="recordTable">
    <table id="records">
      <thead>
        <tr>
          <th>日時</th>
          <th>名前</th>
          <th>入退室</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>2021-01-01 12:34:56</td>
          <td>山田太郎</td>
          <td>入室</td>
        </tr>
      </tbody>
    </table>
  </div>
  <div id="productName"></div>
  <div id="idm"></div>
  <div id="message"></div>
  <button id="startReadingButton">カード読み込み開始</button>

  <script>
    // Fetch data from Google Apps Script
        function fetchData() {
            google.script.run.withSuccessHandler(function (data) {
                var table = document.getElementById('records');
                // Clear the table first
                while (table.rows.length > 1) {
                    table.deleteRow(1);
                }
                // Then add new data
                for (var i = 0; i < data.length; i++) {
                    var row = table.insertRow(-1);
                    for (var j = 0; j < data[i].length; j++) {
                        var cell = row.insertCell(-1);
                        // Check if the data is a Date object
                        console.log(data[i][j]);
                        cell.innerHTML = data[i][j];
                    }
                }
            }).getRecordList();
        }
        // Fetch data every second
        setInterval(fetchData, 3000);
  </script>
</body>

</html>